!function($,t){"use strict";function e(s,i){this.$element=s,this.options=$.extend({},e.defaults,this.$element.data(),i),this._init(),t.registerPlugin(this),t.Keyboard.register("Dropdown",{ENTER:"open",SPACE:"open",ESCAPE:"close",TAB:"tab_forward",SHIFT_TAB:"tab_backward"})}e.defaults={hoverDelay:250,hover:!1,vOffset:1,hOffset:1,positionClass:"",trapFocus:!1,autoFocus:!1},e.prototype._init=function(){var e=this.$element.attr("id");this.$anchor=$('[data-toggle="'+e+'"]')||$('[data-open="'+e+'"]'),this.$anchor.attr({"aria-controls":e,"data-is-focus":!1,"data-yeti-box":e,"aria-haspopup":!0,"aria-expanded":!1}),this.options.positionClass=this.getPositionClass(),this.counter=4,this.usedPositions=[],this.$element.attr({"aria-hidden":"true","data-yeti-box":e,"data-resize":e,"aria-labelledby":this.$anchor[0].id||t.GetYoDigits(6,"dd-anchor")}),this._events()},e.prototype.getPositionClass=function(){var t=this.$element[0].className.match(/(top|left|right)/g);return t=t?t[0]:""},e.prototype._reposition=function(t){this.usedPositions.push(t?t:"bottom"),!t&&this.usedPositions.indexOf("top")<0?this.$element.addClass("top"):"top"===t&&this.usedPositions.indexOf("bottom")<0?this.$element.removeClass(t):"left"===t&&this.usedPositions.indexOf("right")<0?this.$element.removeClass(t).addClass("right"):"right"===t&&this.usedPositions.indexOf("left")<0?this.$element.removeClass(t).addClass("left"):!t&&this.usedPositions.indexOf("top")>-1&&this.usedPositions.indexOf("left")<0?this.$element.addClass("left"):"top"===t&&this.usedPositions.indexOf("bottom")>-1&&this.usedPositions.indexOf("left")<0?this.$element.removeClass(t).addClass("left"):"left"===t&&this.usedPositions.indexOf("right")>-1&&this.usedPositions.indexOf("bottom")<0?this.$element.removeClass(t):"right"===t&&this.usedPositions.indexOf("left")>-1&&this.usedPositions.indexOf("bottom")<0?this.$element.removeClass(t):this.$element.removeClass(t),this.classChanged=!0,this.counter--},e.prototype._setPosition=function(){if("false"===this.$anchor.attr("aria-expanded"))return!1;var e=this.getPositionClass(),s=t.Box.GetDimensions(this.$element),i=t.Box.GetDimensions(this.$anchor),o=this,n="left"===e?"left":"right"===e?"left":"top",h="top"===n?"height":"width",a="height"===h?this.options.vOffset:this.options.hOffset;if(s.width>=s.windowDims.width||!this.counter&&!t.Box.ImNotTouchingYou(this.$element))return this.$element.offset(t.Box.GetOffsets(this.$element,this.$anchor,"center bottom",this.options.vOffset,this.options.hOffset,!0)).css({width:s.windowDims.width-2*this.options.hOffset,height:"auto"}),this.classChanged=!0,!1;for(this.$element.offset(t.Box.GetOffsets(this.$element,this.$anchor,e,this.options.vOffset,this.options.hOffset));!t.Box.ImNotTouchingYou(this.$element)&&this.counter;)this._reposition(e),this._setPosition()},e.prototype._events=function(){var e=this;this.$element.on({"open.zf.trigger":this.open.bind(this),"close.zf.trigger":this.close.bind(this),"toggle.zf.trigger":this.toggle.bind(this),"resizeme.zf.trigger":this._setPosition.bind(this)}),this.options.hover&&this.$anchor.off("mouseenter.zf.dropdown mouseleave.zf.dropdown").on("mouseenter.zf.dropdown",function(){clearTimeout(e.timeout),e.timeOut=setTimeout(function(){e.open(),e.$anchor.data("hover",!0)},e.options.hoverDelay)}).on("mouseleave.zf.dropdown",function(){clearTimeout(e.timeout),e.timeOut=setTimeout(function(){e.close(),e.$anchor.data("hover",!1)},e.options.hoverDelay)}),this.$anchor.add(this.$element).on("keydown.zf.dropdown",function(s){var i=t.Keyboard.findFocusable(e.$element);t.Keyboard.handleKey(s,e,{tab_forward:function(){this.$element.find(":focus").is(i.eq(-1))&&(this.options.trapFocus?(i.eq(0).focus(),s.preventDefault()):this.close())},tab_backward:function(){(this.$element.find(":focus").is(i.eq(0))||this.$element.is(":focus"))&&(this.options.trapFocus?(i.eq(-1).focus(),s.preventDefault()):this.close())},open:function(){e.open(),e.$element.attr("tabindex",-1).focus()},close:function(){e.close(),e.$anchor.focus()}})})},e.prototype.open=function(){if(this.$element.trigger("closeme.zf.dropdown",this.$element.attr("id")),this.$anchor.addClass("hover").attr({"aria-expanded":!0}),this._setPosition(),this.$element.addClass("is-open").attr({"aria-hidden":!1}),this.options.autoFocus){var e=t.Keyboard.findFocusable(this.$element);e.length&&e.eq(0).focus()}this.$element.trigger("show.zf.dropdown",[this.$element])},e.prototype.close=function(){if(!this.$element.hasClass("is-open"))return!1;if(this.$element.removeClass("is-open").attr({"aria-hidden":!0}),this.$anchor.removeClass("hover").attr("aria-expanded",!1),this.classChanged){var t=this.getPositionClass();t&&this.$element.removeClass(t),this.$element.addClass(this.options.positionClass).css({height:"",width:""}),this.classChanged=!1,this.counter=4,this.usedPositions.length=0}this.$element.trigger("hide.zf.dropdown",[this.$element])},e.prototype.toggle=function(){if(this.$element.hasClass("is-open")){if(this.$anchor.data("hover"))return;this.close()}else this.open()},e.prototype.destroy=function(){this.$element.off(".zf.trigger").hide(),this.$anchor.off(".zf.dropdown"),t.unregisterPlugin(this)},t.plugin(e,"Dropdown")}(jQuery,window.Foundation);