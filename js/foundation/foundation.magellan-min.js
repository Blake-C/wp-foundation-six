!function(t,$){"use strict";function i(e,n){this.$element=e,this.options=$.extend({},i.defaults,n),this._init(),t.registerPlugin(this)}i.defaults={animationDuration:500,animationEasing:"linear",threshold:50,activeClass:"active",deepLinking:!1},i.prototype._init=function(){var i=this.$element[0].id||t.GetYoDigits(6,"magellan"),e=this;this.$targets=$("[data-magellan-target]"),this.$links=this.$element.find("a"),this.$element.attr({"data-resize":i,"data-scroll":i,id:i}),this.$active=$(),this.scrollPos=parseInt(window.pageYOffset,10),this._events()},i.prototype.calcPoints=function(){var t=this,i=document.body,e=document.documentElement;this.points=[],this.winHeight=Math.round(Math.max(window.innerHeight,document.body.clientHeight)),this.docHeight=Math.round(Math.max(i.scrollHeight,i.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)),this.$targets.each(function(){var i=$(this),e=Math.round(i.offset().top-t.options.threshold);i.targetPoint=e,t.points.push(e)})},i.prototype._events=function(){var t=this,i=$("html, body"),e={duration:t.options.animationDuration,easing:t.options.animationEasing};$(window).one("load",function(){t.calcPoints(),t._updateActive()}),this.$element.on({"resizeme.zf.trigger":this.reflow.bind(this),"scrollme.zf.trigger":this._updateActive.bind(this)}).on("click.zf.magellan",'a[href^="#"]',function(n){n.preventDefault();var s=this.getAttribute("href"),o=$(s).offset().top-t.options.threshold/2;i.stop(!0).animate({scrollTop:o},e)})},i.prototype.reflow=function(){this.calcPoints(),this._updateActive()},i.prototype._updateActive=function(){var t=parseInt(window.pageYOffset,10),i;if(t+this.winHeight===this.docHeight)i=this.points.length-1;else if(t<this.points[0])i=0;else{var e=this.scrollPos<t,n=this,s=this.points.filter(function(i,s){return e?t>=i:i-n.options.threshold<=t});i=s.length?s.length-1:0}if(this.$active.removeClass(this.options.activeClass),this.$active=this.$links.eq(i).addClass(this.options.activeClass),this.options.deepLinking){var o=this.$active[0].getAttribute("href");window.history.pushState?window.history.pushState(null,null,o):window.location.hash=o}this.scrollPos=t,this.$element.trigger("update.zf.magellan",[this.$active])},i.prototype.destroy=function(){this.$element.off(".zf.trigger .zf.magellan").find("."+this.options.activeClass).removeClass(this.options.activeClass);var i=this.$active[0].getAttribute("href");window.location.hash.replace(i,""),t.unregisterPlugin(this)},t.plugin(i,"Magellan"),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=i),"function"==typeof define&&define(["foundation"],function(){return i})}(Foundation,jQuery);