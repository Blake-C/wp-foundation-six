version: '3'
services:
    cli_tools:
        image: digitalblake/light-cli:1.0.0
        volumes:
            - ./:/home/webdev/www
        tty: true

    nginx:
        image: digitalblake/wp-foundation-six-nginx:3.0.0
        volumes:
            - ./:/home/webdev/www
            - ./nginx/nginx.conf:/etc/nginx/conf.d/default.conf
        ports:
            - '443:443'
            - '80:80'
        depends_on:
            - mysql
            - php

    php:
        image: digitalblake/wp-foundation-six-php:5.0.0_8.0.3-fpm
        volumes:
            - ./:/home/webdev/www
            - ./php/php.ini:/usr/local/etc/php/php.ini
        expose:
            - '9000'

    mysql:
        image: mariadb:10.5.9
        volumes:
            - ./data/mysql:/var/lib/mysql
        ports:
            - '3306:3306'
        environment:
            MYSQL_ROOT_PASSWORD: root
            MYSQL_DATABASE: wp_foundation_six
            MYSQL_PASSWORD: root

    phpmyadmin:
        image: phpmyadmin/phpmyadmin
        volumes:
            - ./php/php.ini:/usr/local/etc/php/php.ini
        restart: always
        depends_on:
            - mysql
        ports:
            - '8000:80'
        environment:
            PMA_ARBITRARY: 1
            UPLOAD_LIMIT: 256M
